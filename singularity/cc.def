BootStrap: docker
From: centos

%environment
    # PATHS
    export PATH=/opt/miniconda2/bin:$PATH
    export PATH=/opt/nextflow:$PATH

%runscript
    source activate py27
    alias ll='ls -l'
    alias ipy='ipython'
    alias py='python'

%post
    # bind paths
    mkdir /aloy
    mkdir /aloy/home
    mkdir /aloy/data
    mkdir /aloy/scratch
    mkdir /slgpfs
    
    # update yum
    yum update -y

    # basic packages
    yum install -y gcc \
                   g++ \
                   gcc-c++ \
                   gfortran \
                   gcc-gfortran \
                   cmake \
                   make \
                   git \
                   wget \
                   curl \
                   which \
                   vim \
                   bzip2 \
                   bzip2-devel 

    # conda
    mkdir /opt/miniconda2 
    cd /opt/miniconda2 
    wget https://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh
    bash Miniconda2-latest-Linux-x86_64.sh -p /opt/miniconda2 -b -f
    rm Miniconda2-latest-Linux-x86_64.sh
    export PATH=/opt/miniconda2/bin:$PATH

    # create and activate conda enviroment
    conda create --name=py27 python=2.7.10 -y
    source activate py27

    # utility packages
    pip install ipython
    pip install six # py2/py3 compatibility
    pip install pytest # unit-testing
    pip install autologging # logging handler
    pip install paramiko # ssh client
    pip install termcolor # terminal output with colors
    # data packages
    pip install numpy # best numerical library ever
    pip install pandas # handles table-like datastracture
    pip install h5py # HDF5 via python
    pip install tqdm # handy progress-bar
    # graph packages
    pip install networkx # graph data stracture and algos
    # visualization packages
    pip install matplotlib # chart library :)
    pip install seaborn # prettier graph built on top of matplotlib
    pip install datashader # nice density plot with lot of data
    # ML packages
    pip install scikit-learn # entry level ML in python
    pip install gensim # topic modelling word2vec
    pip install tensorflow # neural network library
    pip install adanet # automl for NN
    pip install keras # NN API
    pip install MulticoreTSNE # tSNA algo
    conda install -y anaconda-client
    conda install -y faiss-cpu -c pytorch # facebook trick for sparsity


