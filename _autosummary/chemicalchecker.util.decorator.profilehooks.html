<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>chemicalchecker.util.decorator.profilehooks module &mdash; chemicalchecker 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../assets/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../assets/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../assets/css/logo.css?v=fc604eda" />
      <link rel="stylesheet" type="text/css" href="../assets/css/overrides.css?v=466af0f7" />

  
    <link rel="shortcut icon" href="../assets/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../assets/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../assets/jquery.js?v=5d32c60e"></script>
        <script src="../assets/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../assets/documentation_options.js?v=8d563738"></script>
        <script src="../assets/doctools.js?v=888ff710"></script>
        <script src="../assets/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../assets/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../assets/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../manifesto.html">Chemical Checker Manifesto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sources.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../signaturization.html">Signaturization</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">chemicalchecker</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">chemicalchecker.util.decorator.profilehooks module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/chemicalchecker.util.decorator.profilehooks.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-chemicalchecker.util.decorator.profilehooks">
<span id="chemicalchecker-util-decorator-profilehooks-module"></span><h1>chemicalchecker.util.decorator.profilehooks module<a class="headerlink" href="#module-chemicalchecker.util.decorator.profilehooks" title="Link to this heading"></a></h1>
<p>Profiling hooks.</p>
<p>This module contains a couple of decorators (<cite>profile</cite> and <cite>coverage</cite>) that
can be used to wrap functions and/or methods to produce profiles and line
coverage reports.  There’s a third convenient decorator (<cite>timecall</cite>) that
measures the duration of function execution without the extra profiling
overhead.</p>
<p>Usage example (Python 2.4 or newer):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">profilehooks</span> <span class="kn">import</span> <span class="n">profile</span><span class="p">,</span> <span class="n">coverage</span>

<span class="nd">@profile</span>    <span class="c1"># or @coverage</span>
<span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span> <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fn</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fn</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span>
</pre></div>
</div>
<p>Or without imports, with some hack</p>
<blockquote>
<div><p>$ python -m profilehooks yourmodule</p>
<p>&#64;profile    # or &#64;coverage
def fn(n):</p>
<blockquote>
<div><p>if n &lt; 2: return 1
else: return n * fn(n-1)</p>
</div></blockquote>
<p>print(fn(42))</p>
</div></blockquote>
<p>Usage example (Python 2.3 or older):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">profilehooks</span> <span class="kn">import</span> <span class="n">profile</span><span class="p">,</span> <span class="n">coverage</span>

<span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span> <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fn</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Now wrap that function in a decorator</span>
<span class="n">fn</span> <span class="o">=</span> <span class="n">profile</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="c1"># or coverage(fn)</span>

<span class="nb">print</span> <span class="n">fn</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
<p>Reports for all thusly decorated functions will be printed to sys.stdout
on program termination.  You can alternatively request for immediate
reports for each call by passing immediate=True to the profile decorator.</p>
<p>There’s also a &#64;timecall decorator for printing the time to sys.stderr
every time a function is called, when you just want to get a rough measure
instead of a detailed (but costly) profile.</p>
<p>Caveats</p>
<blockquote>
<div><p>A thread on python-dev convinced me that hotshot produces bogus numbers.
See <a class="reference external" href="https://mail.python.org/pipermail/python-dev/2005-November/058264.html">https://mail.python.org/pipermail/python-dev/2005-November/058264.html</a></p>
<p>I don’t know what will happen if a decorated function will try to call
another decorated function.  All decorators probably need to explicitly
support nested profiling (currently TraceFuncCoverage is the only one
that supports this, while HotShotFuncProfile has support for recursive
functions.)</p>
<p>Profiling with hotshot creates temporary files (<a href="#id1"><span class="problematic" id="id2">*</span></a>.prof for profiling,
<a href="#id3"><span class="problematic" id="id4">*</span></a>.cprof for coverage) in the current directory.  These files are not
cleaned up.  Exception: when you specify a filename to the profile
decorator (to store the pstats.Stats object for later inspection),
the temporary file will be the filename you specified with ‘.raw’
appended at the end.</p>
<p>Coverage analysis with hotshot seems to miss some executions resulting
in lower line counts and some lines errorneously marked as never
executed.  For this reason coverage analysis now uses trace.py which is
slower, but more accurate.</p>
</div></blockquote>
<p>Copyright (c) 2004–2017 Marius Gedminas &lt;<a class="reference external" href="mailto:marius&#37;&#52;&#48;gedmin&#46;as">marius<span>&#64;</span>gedmin<span>&#46;</span>as</a>&gt;
Copyright (c) 2007 Hanno Schlichting
Copyright (c) 2008 Florian Schulze</p>
<p>Released under the MIT licence since December 2006:</p>
<blockquote>
<div><p>Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the “Software”),
to deal in the Software without restriction, including without limitation
the rights to use, copy, modify, merge, publish, distribute, sublicense,
and/or sell copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.</p>
</div></blockquote>
<p>(Previously it was distributed under the GNU General Public Licence.)</p>
<dl class="py function">
<dt class="sig sig-object py" id="chemicalchecker.util.decorator.profilehooks.coverage">
<span class="sig-name descname"><span class="pre">coverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/chemicalchecker/util/decorator/profilehooks.html#coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#chemicalchecker.util.decorator.profilehooks.coverage" title="Link to this definition"></a></dt>
<dd><p>Mark <cite>fn</cite> for line coverage analysis.</p>
<p>Results will be printed to sys.stdout on program termination.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="o">...</span>
<span class="n">fn</span> <span class="o">=</span> <span class="n">coverage</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
</pre></div>
</div>
<p>If you are using Python 2.4, you should be able to use the decorator
syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@coverage</span>
<span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemicalchecker.util.decorator.profilehooks.coverage_with_hotshot">
<span class="sig-name descname"><span class="pre">coverage_with_hotshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/chemicalchecker/util/decorator/profilehooks.html#coverage_with_hotshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#chemicalchecker.util.decorator.profilehooks.coverage_with_hotshot" title="Link to this definition"></a></dt>
<dd><p>Mark <cite>fn</cite> for line coverage analysis.</p>
<p>Uses the ‘hotshot’ module for fast coverage analysis.</p>
<p>BUG: Produces inaccurate results.</p>
<p>See the docstring of <cite>coverage</cite> for usage examples.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemicalchecker.util.decorator.profilehooks.profile">
<span class="sig-name descname"><span class="pre">profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">immediate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profiler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('cProfile',</span> <span class="pre">'profile',</span> <span class="pre">'hotshot')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/chemicalchecker/util/decorator/profilehooks.html#profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#chemicalchecker.util.decorator.profilehooks.profile" title="Link to this definition"></a></dt>
<dd><p>Mark <cite>fn</cite> for profiling.</p>
<p>If <cite>skip</cite> is &gt; 0, first <cite>skip</cite> calls to <cite>fn</cite> will not be profiled.</p>
<p>If <cite>immediate</cite> is False, profiling results will be printed to
sys.stdout on program termination.  Otherwise results will be printed
after each call.  (If you don’t want this, set stdout=False and specify a
<cite>filename</cite> to store profile data.)</p>
<p>If <cite>dirs</cite> is False only the name of the file will be printed.
Otherwise the full path is used.</p>
<p><cite>sort</cite> can be a list of sort keys (defaulting to [‘cumulative’,
‘time’, ‘calls’]).  The following ones are recognized:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;calls&#39;</span>      <span class="o">--</span> <span class="n">call</span> <span class="n">count</span>
<span class="s1">&#39;cumulative&#39;</span> <span class="o">--</span> <span class="n">cumulative</span> <span class="n">time</span>
<span class="s1">&#39;file&#39;</span>       <span class="o">--</span> <span class="n">file</span> <span class="n">name</span>
<span class="s1">&#39;line&#39;</span>       <span class="o">--</span> <span class="n">line</span> <span class="n">number</span>
<span class="s1">&#39;module&#39;</span>     <span class="o">--</span> <span class="n">file</span> <span class="n">name</span>
<span class="s1">&#39;name&#39;</span>       <span class="o">--</span> <span class="n">function</span> <span class="n">name</span>
<span class="s1">&#39;nfl&#39;</span>        <span class="o">--</span> <span class="n">name</span><span class="o">/</span><span class="n">file</span><span class="o">/</span><span class="n">line</span>
<span class="s1">&#39;pcalls&#39;</span>     <span class="o">--</span> <span class="n">call</span> <span class="n">count</span>
<span class="s1">&#39;stdname&#39;</span>    <span class="o">--</span> <span class="n">standard</span> <span class="n">name</span>
<span class="s1">&#39;time&#39;</span>       <span class="o">--</span> <span class="n">internal</span> <span class="n">time</span>
</pre></div>
</div>
<p><cite>entries</cite> limits the output to the first N entries.</p>
<p><cite>profiler</cite> can be used to select the preferred profiler, or specify a
sequence of them, in order of preference.  The default is (‘cProfile’.
‘profile’, ‘hotshot’).</p>
<p>If <cite>filename</cite> is specified, the profile stats will be stored in the
named file.  You can load them with pstats.Stats(filename) or use a
visualization tool like RunSnakeRun.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="o">...</span>
<span class="n">fn</span> <span class="o">=</span> <span class="n">profile</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>If you are using Python 2.4, you should be able to use the decorator
syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@profile</span><span class="p">(</span><span class="n">skip</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>or just</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemicalchecker.util.decorator.profilehooks.timecall">
<span class="sig-name descname"><span class="pre">timecall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">immediate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/chemicalchecker/util/decorator/profilehooks.html#timecall"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#chemicalchecker.util.decorator.profilehooks.timecall" title="Link to this definition"></a></dt>
<dd><p>Wrap <cite>fn</cite> and print its execution time.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@timecall</span>
<span class="k">def</span> <span class="nf">somefunc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>

<span class="n">somefunc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>will print the time taken by somefunc on every call.  If you want just
a summary at program termination, use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@timecall</span><span class="p">(</span><span class="n">immediate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also choose a timing method other than the default
<code class="docutils literal notranslate"><span class="pre">timeit.default_timer()</span></code>, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@timecall</span><span class="p">(</span><span class="n">timer</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">clock</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, SBNB.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>