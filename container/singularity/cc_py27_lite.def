BootStrap: docker
From: centos

%environment
    # PATHS
    export PATH=/opt/miniconda2/bin:$PATH
    source activate py27

%post
    # bind paths
    mkdir /aloy
    mkdir /aloy/home
    mkdir /aloy/data
    mkdir /aloy/scratch
    mkdir /aloy/web_checker
    mkdir /slgpfs
    
    # update yum
    yum update -y

    # basic packages
    yum install -y gcc \
                   gcc-c++ \
                   gcc-gfortran \
                   cmake \
                   make \
                   git \
                   wget \
                   curl \
                   which \
                   vim \
                   bzip2 \
                   bzip2-devel \
                   file \
                   libXrender \
                   libXext \
                   postgresql-server \
                   postgresql-contrib \
                   epel-release 

    # conda
    mkdir /opt/miniconda2 
    cd /opt/miniconda2 
    wget https://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh
    bash Miniconda2-latest-Linux-x86_64.sh -p /opt/miniconda2 -b -f
    rm Miniconda2-latest-Linux-x86_64.sh
    export PATH=/opt/miniconda2/bin:$PATH

    # create and activate conda enviroment
    conda create --name=py27 python=2.7 -y
    source activate py27

    # basic requirements
    pip install numpy
    pip install h5py
    pip install psycopg2-binary
    pip install pandas
    pip install networkx
    pip install autologging
    pip install scipy
    pip install sqlalchemy
    pip install paramiko
    pip install sklearn
    pip install csvsort
    pip install seaborn
    pip install tqdm
    # unittest utils
    pip install pytest
    pip install mock

